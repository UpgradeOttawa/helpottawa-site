<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Eastern Ontario Hazard Map</title>

  <!-- PWA (optional) -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#0b0f14">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- Leaflet -->
  <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet"/>

  <!-- Your CSS -->
  <link href="./css/styles.css" rel="stylesheet" />
  <style>
    html, body, #map { height: 100%; margin: 0; }
    #map { height: calc(100vh - 64px); }

    .topbar {
      height: 64px;
      background: #0b0f14;
      border-bottom: 1px solid rgba(255,255,255,.08);
      position: sticky; top: 0; z-index: 1000;
    }
    .hazard-pill {
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      color: #e6eef7;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 700;
      letter-spacing: .2px;
      cursor: pointer;
      user-select: none;
    }
    .hazard-pill.active {
      outline: 2px solid rgba(0, 255, 200, .35);
      background: rgba(0,255,200,.08);
    }

    /* Contrast fix for panel labels */
    .offcanvas .form-check-label { color: #e6eef7 !important; }
    .offcanvas .text-secondary { color: rgba(230,238,247,.72) !important; }
    .offcanvas .card { background: #070b10 !important; }
    .brand-sponsor {
      display:flex; align-items:center; gap:10px;
      color: rgba(230,238,247,.8);
      font-size: 12px;
      white-space: nowrap;
    }
    .sponsor-box {
      width: 140px; height: 34px;
      border-radius: 10px;
      border: 1px dashed rgba(255,255,255,.28);
      display:flex; align-items:center; justify-content:center;
      font-weight: 700;
      color: rgba(230,238,247,.65);
    }
  </style>
</head>

<body class="bg-dark text-light">
  <div class="topbar px-3 d-flex align-items-center justify-content-between gap-3">
    <div class="d-flex align-items-center gap-3">
      <div>
        <div class="fw-bold">Eastern Ontario Hazard Map</div>
        <div class="small text-secondary">Prototype • region heat + submissions • guidance only</div>
      </div>
    </div>

    <div class="d-flex align-items-center gap-2">
      <div class="d-none d-md-flex align-items-center gap-2">
        <div class="hazard-pill active" data-hazard="asbestos">ASBESTOS</div>
        <div class="hazard-pill" data-hazard="mold">Mold</div>
        <div class="hazard-pill" data-hazard="radon">Radon</div>
        <div class="hazard-pill" data-hazard="lead">Lead</div>
      </div>

      <div class="brand-sponsor d-none d-md-flex">
        <span>Sponsored by</span>
        <div class="sponsor-box">YOUR LOGO</div>
      </div>

      <button class="btn btn-outline-info btn-sm" data-bs-toggle="offcanvas" data-bs-target="#panel">
        Controls
      </button>
    </div>
  </div>

  <div id="map"></div>

  <!-- Offcanvas controls -->
  <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="panel">
    <div class="offcanvas-header border-bottom border-secondary">
      <h5 class="offcanvas-title">Controls</h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>

    <div class="offcanvas-body">
      <div class="card border-secondary mb-3">
        <div class="card-body">
          <div class="fw-semibold mb-2">Layers</div>

          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="toggleHeat" checked>
            <label class="form-check-label" for="toggleHeat">Heatmap</label>
          </div>

          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="toggleRegions" checked>
            <label class="form-check-label" for="toggleRegions">Regions (84)</label>
          </div>

          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="toggleCompanies" checked>
            <label class="form-check-label" for="toggleCompanies">Companies (demo)</label>
          </div>

          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="toggleSubmissions" checked>
            <label class="form-check-label" for="toggleSubmissions">My submissions</label>
          </div>
        </div>
      </div>

      <div class="card border-secondary mb-3">
        <div class="card-body">
          <div class="fw-semibold mb-2">Filters</div>

          <label class="form-label small text-secondary">Era</label>
          <select id="eraSelect" class="form-select form-select-sm mb-3"></select>

          <label class="form-label small text-secondary">Minimum intensity</label>
          <input id="minCoeff" type="range" min="0" max="1" step="0.01" value="0" class="form-range">
        </div>
      </div>

      <div class="card border-secondary">
        <div class="card-body">
          <div class="fw-semibold mb-2">Add a location (privacy-safe)</div>
          <div class="small text-secondary mb-2">
            We do NOT store exact pinpoints in the heat layer. We scatter randomized points around the area.
          </div>

          <label class="form-label small text-secondary">Address</label>
          <input id="addrInput" class="form-control form-control-sm mb-2" placeholder="e.g., 991 Harkness Ave, Ottawa">

          <div class="row g-2">
            <div class="col-6">
              <label class="form-label small text-secondary">Hazard</label>
              <select id="hazardSelect" class="form-select form-select-sm">
                <option value="asbestos" selected>Asbestos</option>
                <option value="mold">Mold</option>
                <option value="radon">Radon</option>
                <option value="lead">Lead</option>
              </select>
            </div>
            <div class="col-6">
              <label class="form-label small text-secondary">Strength</label>
              <select id="strengthSelect" class="form-select form-select-sm">
                <option value="0.6">Medium</option>
                <option value="0.85" selected>High</option>
                <option value="1.0">Very High</option>
              </select>
            </div>
          </div>

          <button id="btnSubmitAddr" class="btn btn-info btn-sm w-100 mt-3">Add area heat</button>

          <div class="small text-secondary mt-2">
            Tip: you can also click the map to add a scattered neighborhood heat (test mode).
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>

  <script src="./js/app.js"></script>
  <script src="./js/submit.js"></script>
</body>
</html>

